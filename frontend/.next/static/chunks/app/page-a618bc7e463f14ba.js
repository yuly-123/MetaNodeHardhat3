(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1318:function(e,r,a){Promise.resolve().then(a.bind(a,5710))},5710:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return _}});var t=a(7437),s=a(2265),l=a(5764),n=a(7272),o=a(7415),i=a(7774);let d="0x99f88850cEc7e2842e40eCFF2739B6A77c941E0D";var c=a(410),x=a(1396),m=a.n(x),g=a(3008),h=a(2104),p=a(6141),u=a(2898);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let b=(0,u.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var y=a(5750),f=a(3605),v=a(9246);function k(e){let{campaign:r}=e,a=r.goal>0n?Math.min(Number(r.totalRaised)/Number(r.goal)*100,100):0;r.deadline;let s=2===r.state?g.Z:3===r.state?h.Z:p.Z;return(0,t.jsx)(m(),{href:"/campaign/".concat(r.address),children:(0,t.jsxs)("div",{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 p-6 cursor-pointer group border border-gray-200/50 dark:border-slate-700/50 hover:border-primary-300 dark:hover:border-primary-700 relative overflow-hidden transform hover:-translate-y-1",children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-primary-500/5 to-purple-500/5 rounded-full blur-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,t.jsxs)("div",{className:"flex items-start justify-between mb-5 relative z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg ".concat(2===r.state?"bg-green-100 dark:bg-green-900/30":3===r.state?"bg-red-100 dark:bg-red-900/30":"bg-blue-100 dark:bg-blue-900/30"),children:(0,t.jsx)(s,{className:"w-5 h-5 ".concat(2===r.state?"text-green-600 dark:text-green-400":3===r.state?"text-red-600 dark:text-red-400":"text-blue-600 dark:text-blue-400")})}),(0,t.jsx)("span",{className:"text-xs font-semibold px-3 py-1.5 rounded-full ".concat({0:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",1:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",2:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",3:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",4:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}[r.state]," border border-current/20"),children:["准备中","进行中","成功","失败","已关闭"][r.state]})]}),(0,t.jsx)(b,{className:"w-5 h-5 text-gray-400 group-hover:text-primary-600 transition-all group-hover:translate-x-1"})]}),(0,t.jsxs)("div",{className:"mb-5 relative z-10",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2 line-clamp-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",children:r.name}),(0,t.jsxs)("p",{className:"text-xs font-mono text-gray-500 dark:text-gray-400",children:[r.address.slice(0,8),"...",r.address.slice(-6)]})]}),(0,t.jsxs)("div",{className:"mb-5 relative z-10",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsxs)("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[f.dF(r.totalRaised)," ETH"]}),(0,t.jsxs)("span",{className:"text-lg font-bold bg-gradient-to-r from-primary-600 to-purple-600 bg-clip-text text-transparent",children:[a.toFixed(1),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden shadow-inner",children:(0,t.jsx)("div",{className:"bg-gradient-to-r from-primary-500 to-purple-500 h-3 rounded-full transition-all duration-500 shadow-sm",style:{width:"".concat(a,"%")}})}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 font-medium",children:["目标: ",f.dF(r.goal)," ETH"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center pt-5 border-t border-gray-200/50 dark:border-gray-700/50 relative z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,t.jsx)(y.Z,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"贡献者"}),(0,t.jsx)("p",{className:"text-base font-bold text-gray-900 dark:text-white",children:r.contributorCount})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"p-2 bg-purple-50 dark:bg-purple-900/20 rounded-lg inline-block mb-1",children:(0,t.jsx)("span",{className:"text-lg",children:"⏰"})}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"最后期限"}),(0,t.jsx)("p",{className:"text-sm font-bold text-gray-900 dark:text-white",children:(0,v.Q)(new Date(1e3*Number(r.deadline)),{addSuffix:!0})})]})]})]})})}var j=a(2549);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let w=(0,u.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);var N=a(5234),C=a(6264);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let E=(0,u.Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);var I=a(2733);let F="0x99f88850cEc7e2842e40eCFF2739B6A77c941E0D";var z=a(4212);function S(e){let{onClose:r,onSuccess:a}=e,{signer:n}=(0,I.useWeb3)(),{createCampaign:d}=function(){let{signer:e}=(0,l.$)();return{createCampaign:async(r,a,t)=>{if(console.log("useFactory.createCampaign called with:",{name:r,goal:a,durationInDays:t}),!e)throw console.error("Signer is null"),Error("钱包未连接，请先连接钱包");if(!F)throw console.error("Factory address not configured"),Error("工厂合约地址未配置");if(!r||0===r.trim().length)throw Error("活动名称不能为空");try{console.log("Creating factory contract instance...");let s=new o.CH(F,i.W,e);console.log("Calling createCampaign on factory...");let l=f.fi(a);console.log("Goal in wei:",l.toString());let n=await s.createCampaign(r.trim(),l,t);console.log("Transaction sent:",n.hash),console.log("Waiting for transaction confirmation...");let d=await n.wait();return console.log("Transaction confirmed:",d),d}catch(e){if(console.error("Error in createCampaign:",e),"ACTION_REJECTED"===e.code)throw Error("用户取消了交易");if("INSUFFICIENT_FUNDS"===e.code)throw Error("余额不足，请确保账户有足够的 ETH");if(e.reason)throw Error(e.reason);throw e}}}}(),{showSuccess:c,showError:x,showWarning:m}=(0,z.useAlert)(),[g,h]=(0,s.useState)(""),[u,b]=(0,s.useState)(""),[y,v]=(0,s.useState)("7"),[k,S]=(0,s.useState)(!1),Z=async e=>{if(e.preventDefault(),!n){m("请先连接钱包！","提示"),console.error("Signer is null");return}if(!u||0>=parseFloat(u)){m("请输入有效的目标金额（大于 0）","提示"),console.error("Invalid goal:",u);return}if(!g||0===g.trim().length){m("请输入活动名称","提示"),console.error("Invalid name:",g);return}if(!y||1>parseInt(y)||parseInt(y)>90){m("持续时间必须在 1-90 天之间","提示"),console.error("Invalid duration:",y);return}try{console.log("Creating campaign with:",{name:g,goal:u,duration:parseInt(y)}),S(!0),await d(g.trim(),u,parseInt(y)),console.log("Campaign created successfully"),c("活动创建成功！","成功"),a()}catch(r){console.error("Error creating campaign:",r);let e=(null==r?void 0:r.reason)||(null==r?void 0:r.message)||"创建活动失败";x("创建失败: ".concat(e),"错误")}finally{S(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",onClick:r,children:(0,t.jsxs)("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-2xl max-w-md w-full p-8 animate-scale-in border border-gray-200/50 dark:border-slate-700/50 relative overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-primary-500/10 to-purple-500/10 rounded-full blur-3xl -z-0"}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-gradient-to-tr from-blue-500/10 to-cyan-500/10 rounded-full blur-3xl -z-0"}),(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-primary-600 to-purple-600 bg-clip-text text-transparent",children:"创建活动"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"在区块链上发起您的众筹项目"})]}),(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-all hover:rotate-90 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800",children:(0,t.jsx)(j.Z,{className:"w-6 h-6"})})]}),(0,t.jsxs)("form",{onSubmit:Z,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(w,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),"活动名称"]})}),(0,t.jsx)("input",{type:"text",value:g,onChange:e=>h(e.target.value),required:!0,maxLength:100,className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-slate-800 dark:text-white transition-all shadow-sm hover:shadow-md",placeholder:"例如：帮助贫困学生完成学业"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"为您的众筹活动起一个吸引人的名称"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.Z,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),"目标金额 (ETH)"]})}),(0,t.jsx)("input",{type:"number",step:"0.01",min:"0.01",value:u,onChange:e=>b(e.target.value),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-slate-800 dark:text-white transition-all shadow-sm hover:shadow-md",placeholder:"10.0"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"设置您希望筹集的总金额"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),"持续时间 (天)"]})}),(0,t.jsx)("input",{type:"number",min:"1",max:"90",value:y,onChange:e=>v(e.target.value),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-slate-800 dark:text-white transition-all shadow-sm hover:shadow-md",placeholder:"7"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"活动持续时间，范围：1-90 天"})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-6",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"flex-1 px-6 py-3 border-2 border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-slate-800 transition-all font-medium shadow-sm hover:shadow-md",children:"取消"}),(0,t.jsx)("button",{type:"submit",disabled:k||!g||!u||!y||0===g.trim().length||0>=parseFloat(u)||1>parseInt(y)||parseInt(y)>90,className:"flex-1 px-6 py-3 bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 text-white rounded-xl font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-[1.02] disabled:hover:scale-100",onClick:e=>{console.log("Create Campaign button clicked",{isCreating:k,goal:u,duration:y,signer:!!n,disabled:k||!u||!y||0>=parseFloat(u)||1>parseInt(y)||parseInt(y)>90})},children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Z,{className:"w-5 h-5 animate-spin"}),"创建中..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(E,{className:"w-5 h-5"}),"创建活动"]})})]})]})]})]})})}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let Z=(0,u.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function _(){let{account:e,connectWallet:r,isConnecting:a}=(0,l.$)(),{campaigns:x,loading:m,refresh:g}=function(){let{provider:e}=(0,l.$)(),[r,a]=(0,s.useState)([]),[t,c]=(0,s.useState)(!0),x=(0,s.useCallback)(async()=>{if(!e||!d){console.warn("Missing provider or factory address:",{provider:!!e,factoryAddress:d}),c(!1);return}try{if(c(!0),!n.UJ(d))throw Error("Invalid factory address: ".concat(d));let r=await e.getNetwork();console.log("Current network:",{chainId:Number(r.chainId),name:r.name});let t=await e.getCode(d);if("0x"===t)throw Error("No contract found at address ".concat(d," on chain ").concat(r.chainId));console.log("Contract code found, length:",t.length);let s=new o.CH(d,i.W,e),l=(await s.getCampaigns()).map(async r=>{let a=new o.CH(r,i.CrowdfundingCampaignABI,e),[t,s,l,n,d,c,x]=await Promise.all([a.owner(),a.name(),a.goal(),a.deadline(),a.totalRaised(),a.state(),a.getContributorCount()]);return{address:r,owner:t,name:s,goal:l,totalRaised:d,deadline:n,state:Number(c),contributorCount:Number(x)}}),x=await Promise.all(l);a(x)}catch(e){console.error("Error fetching campaigns:",e),a([])}finally{c(!1)}},[e]);return(0,s.useEffect)(()=>{x()},[x]),{campaigns:r,loading:t,refresh:x}}(),[h,p]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{e&&g()},[e]),(0,t.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[(0,t.jsxs)("div",{className:"fixed inset-0 -z-10",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-50 via-blue-50/30 to-purple-50/30 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px]"}),(0,t.jsx)("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-primary-500/10 rounded-full blur-3xl animate-pulse"}),(0,t.jsx)("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl animate-pulse delay-1000"})]}),(0,t.jsx)(c.Z,{}),(0,t.jsxs)("main",{className:"container mx-auto px-4 py-12 relative z-10",children:[(0,t.jsxs)("div",{className:"text-center mb-16 animate-fade-in",children:[(0,t.jsx)("h1",{className:"text-6xl font-bold mb-6 bg-gradient-to-r from-gray-900 via-primary-600 to-purple-600 dark:from-white dark:via-primary-400 dark:to-purple-400 bg-clip-text text-transparent",children:"去中心化众筹"}),(0,t.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto leading-relaxed",children:"在区块链上创建和支持项目。透明、安全、社区驱动。"})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-10",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"积极行动"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:m?"加载中...":"找到 ".concat(x.length," 个活动")})]}),e?(0,t.jsxs)("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-2xl transform hover:scale-105",children:[(0,t.jsx)(Z,{className:"w-5 h-5"}),"+ 创建活动"]}):(0,t.jsx)("button",{onClick:r,disabled:a,className:"flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-2xl transform hover:scale-105 disabled:opacity-50 disabled:hover:scale-100",children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Z,{className:"w-5 h-5 animate-spin"}),"连接中..."]}):"连接钱包"})]}),m?(0,t.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,t.jsx)(C.Z,{className:"w-8 h-8 animate-spin text-primary-600"})}):0===x.length?(0,t.jsxs)("div",{className:"text-center py-24",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-32 h-32 rounded-full bg-gradient-to-br from-primary-100 to-purple-100 dark:from-primary-900/20 dark:to-purple-900/20 mb-6",children:(0,t.jsx)("svg",{className:"w-16 h-16 text-primary-600 dark:text-primary-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"暂无活动"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-lg mb-6",children:e?"成为第一个创建活动的人吧！":"连接钱包以创建或查看活动"}),e&&(0,t.jsxs)("button",{onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-primary-600 to-purple-600 hover:from-primary-700 hover:to-purple-700 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-2xl transform hover:scale-105",children:[(0,t.jsx)(Z,{className:"w-5 h-5"}),"创建第一个活动"]})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:x.map((e,r)=>(0,t.jsx)(k,{campaign:e},r))})]}),h&&(0,t.jsx)(S,{onClose:()=>p(!1),onSuccess:()=>{p(!1),g()}})]})}}},function(e){e.O(0,[945,967,344,971,938,744],function(){return e(e.s=1318)}),_N_E=e.O()}]);